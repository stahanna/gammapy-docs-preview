
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "tutorials/scripts/survey_map.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_tutorials_scripts_survey_map.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_tutorials_scripts_survey_map.py:


Survey Map Script
=================

Make a survey counts map using a script.

We create an all-sky map in AIT projection for the
`H.E.S.S. DL3 DR1 <https://www.mpi-hd.mpg.de/hfm/HESS/pages/dl3-dr1/>`__
dataset.

.. GENERATED FROM PYTHON SOURCE LINES 11-34


.. rst-class:: sphx-glr-script-out

.. code-block:: pytb

    Traceback (most recent call last):
      File "/home/hstapel/PycharmProjects/projekt_gammapy/gammapy/examples/tutorials/scripts/survey_map.py", line 33, in <module>
        main()
      File "/home/hstapel/PycharmProjects/projekt_gammapy/gammapy/examples/tutorials/scripts/survey_map.py", line 19, in main
        data_store = DataStore.from_dir("$GAMMAPY_DATA/hess-dl3-dr1")
      File "/home/hstapel/PycharmProjects/projekt_gammapy/gammapy/.tox/build_docs/lib64/python3.9/site-packages/gammapy/data/data_store.py", line 173, in from_dir
        raise OSError(f"File not found: {hdu_table_filename}")
    OSError: File not found: gammapy-data/hess-dl3-dr1/hdu-index.fits.gz






|

.. code-block:: Python

    import logging
    from gammapy.data import DataStore
    from gammapy.maps import Map

    log = logging.getLogger(__name__)


    def main():
        data_store = DataStore.from_dir("$GAMMAPY_DATA/hess-dl3-dr1")
        obs_id = data_store.obs_table["OBS_ID"]
        observations = data_store.get_observations(obs_id)

        m = Map.create()
        for obs in observations:
            log.info(f"Processing obs_id: {obs.obs_id}")
            m.fill_events(obs.events)

        m.write("survey_map.fits.gz", overwrite=True)


    if __name__ == "__main__":
        logging.basicConfig(level=logging.INFO)
        main()


.. _sphx_glr_download_tutorials_scripts_survey_map.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/gammapy/gammapy-webpage/master?urlpath=lab/tree/notebooks/dev/tutorials/scripts/survey_map.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: survey_map.ipynb <survey_map.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: survey_map.py <survey_map.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
